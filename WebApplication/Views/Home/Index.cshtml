@{
    ViewBag.Title = "Home Page";
}

<div class="jumbotron">
    <h1>ASP.NET</h1>
    <p class="lead">ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS and JavaScript.</p>
    <p><a href="https://asp.net" class="btn btn-primary btn-lg">Learn more &raquo;</a></p>
</div>

<div id="message">message should display here</div>

@section scripts{
    <script src="~/Scripts/jquery.signalR-2.4.1.min.js"></script>
    @*<script src="~/signalr/hubs"></script>*@

    <script type="text/javascript">
        var connection;
        var proxy;

        function Connect() {
            HubServerUrl = "https://localhost:44390/";
            var HubUrl = HubServerUrl + "signalr";
            connection = $.hubConnection(HubUrl, {useDefaultPath: false});

            proxy = connection.createHubProxy('messages');
            proxy.on('showMessageOnPage', function (message) {
                alert(message);
                console.log(message);
            });


            //connecting the client to the signalr hub   
            connection.start().done(function () {
                console.log('Now connected, connection ID = ' + connection.id);
                console.log("Transport = " + connection.transport.name);
                alert("Connected to Signalr Server");

                proxy.invoke('ShowNewMessage', 'Hello from the UI')
                    .done(function () {
                        console.log('Invocation of showMessageOnPage succeeded');
                    }).fail(function (error) {
                        console.log('Invocation of showMessageOnPage failed. Error: ' + error);
                    });
            })
                .fail(function () {
                    alert("failed in connecting to the signalr server");
            })

        } 

        Connect();
    </script>
}